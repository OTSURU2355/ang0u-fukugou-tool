<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æš—å·åŒ–ãƒ»å¾©å·åŒ–ãƒ„ãƒ¼ãƒ«</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      background: linear-gradient(to right, #dfe9f3, #ffffff);
      color: #333;
      max-width: 800px;
      margin: auto;
    }
    textarea, input, button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 1em;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
    #history {
      margin-top: 20px;
      padding: 10px;
      background: #ffffff;
      border: 1px solid #ccc;
      max-height: 200px;
      overflow-y: auto;
    }
    .history-entry {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 4px 0;
      border-bottom: 1px solid #eee;
    }
    .history-text {
      flex-grow: 1;
      overflow-wrap: anywhere;
    }
    .delete-btn {
      background: none;
      border: none;
      color: #d00;
      font-size: 1em;
      cursor: pointer;
      margin-left: 10px;
    }
    .delete-btn:hover {
      color: #a00;
    }
    .footer {
      margin-top: 30px;
      text-align: center;
      font-size: 0.9em;
    }
    .footer a {
      color: #007bff;
      text-decoration: none;
    }
    .footer a:hover {
      text-decoration: underline;
    }
    .top-buttons {
      display: flex;
      gap: 10px;
    }
  </style>
</head>
<body>
  <h1>æš—å·åŒ–ãƒ»å¾©å·åŒ–ãƒ„ãƒ¼ãƒ«</h1>

  <label for="inputText">ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›:</label>
  <textarea id="inputText" rows="4"></textarea>

  <div class="top-buttons">
    <button onclick="encrypt()">ğŸ” æš—å·åŒ–</button>
    <button onclick="decrypt()">ğŸ”“ å¾©å·åŒ–</button>
    <button onclick="clearFields()">ğŸ§¹ ã‚¯ãƒªã‚¢</button>
    <button onclick="downloadOutput()">â¬‡ï¸ çµæœã‚’ä¿å­˜</button>
    <input type="file" id="uploadFile" accept=".txt" onchange="loadFromFile(event)">
  </div>

  <label><input type="checkbox" id="autoCopy"> å¤‰æ›å¾Œã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªå‹•çš„ã«å…¥åŠ›æ¬„ã¸ã‚³ãƒ”ãƒ¼</label>

  <label for="outputText">çµæœ:</label>
  <textarea id="outputText" rows="6" readonly></textarea>
  <button onclick="copyToClipboard()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>

  <h2>å±¥æ­´</h2>
  <button onclick="clearHistory()">ğŸ—‘ï¸ å±¥æ­´ã‚’å…¨å‰Šé™¤</button>
  <input type="text" id="historySearch" placeholder="å±¥æ­´ã‚’æ¤œç´¢..." oninput="filterHistory()">
  <div id="history"></div>

  <div class="footer">
    <p><a href="https://youtu.be/dQw4w9WgXcQ" target="_blank">ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯</a></p>
  </div>

  <script>
    const table = {
      "ã‚": "1-1", "ã„": "1-2", "ã†": "1-3", "ãˆ": "1-4", "ãŠ": "1-5",
      "ã‹": "2-1", "ãŒ": "2=1", "ã": "2-2", "ã": "2=2", "ã": "2-3", "ã": "2=3", "ã‘": "2-4", "ã’": "2=4", "ã“": "2-5", "ã”": "2=5",
      "ã•": "3-1", "ã–": "3=1", "ã—": "3-2", "ã˜": "3=2", "ã™": "3-3", "ãš": "3=3", "ã›": "3-4", "ãœ": "3=4", "ã": "3-5", "ã": "3=5",
      "ãŸ": "4-1", "ã ": "4=1", "ã¡": "4-2", "ã¢": "4=2", "ã¤": "4-3", "ã¥": "4=3", "ã¦": "4-4", "ã§": "4=4", "ã¨": "4-5", "ã©": "4=5",
      "ãª": "5-1", "ã«": "5-2", "ã¬": "5-3", "ã­": "5-4", "ã®": "5-5",
      "ã¯": "6-1", "ã°": "6=1", "ã±": "6^1", "ã²": "6-2", "ã³": "6=2", "ã´": "6^2", "ãµ": "6-3", "ã¶": "6=3", "ã·": "6^3", "ã¸": "6-4", "ã¹": "6=4", "ãº": "6^4", "ã»": "6-5", "ã¼": "6=5", "ã½": "6^5",
      "ã¾": "7-1", "ã¿": "7-2", "ã‚€": "7-3", "ã‚": "7-4", "ã‚‚": "7-5",
      "ã‚„": "8-1", "ã‚†": "8-3", "ã‚ˆ": "8-5",
      "ã‚‰": "9-1", "ã‚Š": "9-2", "ã‚‹": "9-3", "ã‚Œ": "9-4", "ã‚": "9-5",
      "ã‚": "10-1", "ã‚’": "10-3", "ã‚“": "10-5",
      "ã‚¢": "1'-1", "ã‚¤": "1'-2", "ã‚¦": "1'-3", "ã‚¨": "1'-4", "ã‚ª": "1'-5",
      "ã‚«": "2'-1", "ã‚¬": "2'=1", "ã‚­": "2'-2", "ã‚®": "2'=2", "ã‚¯": "2'-3", "ã‚°": "2'=3", "ã‚±": "2'-4", "ã‚²": "2'=4", "ã‚³": "2'-5", "ã‚´": "2'=5",
      "ã‚µ": "3'-1", "ã‚¶": "3'=1", "ã‚·": "3'-2", "ã‚¸": "3'=2", "ã‚¹": "3'-3", "ã‚º": "3'=3", "ã‚»": "3'-4", "ã‚¼": "3'=4", "ã‚½": "3'-5", "ã‚¾": "3'=5",
      "ã‚¿": "4'-1", "ãƒ€": "4'=1", "ãƒ": "4'-2", "ãƒ‚": "4'=2", "ãƒ„": "4'-3", "ãƒ…": "4'=3", "ãƒ†": "4'-4", "ãƒ‡": "4'=4", "ãƒˆ": "4'-5", "ãƒ‰": "4'=5",
      "ãƒŠ": "5'-1", "ãƒ‹": "5'-2", "ãƒŒ": "5'-3", "ãƒ": "5'-4", "ãƒ": "5'-5",
      "ãƒ": "6'-1", "ãƒ": "6'=1", "ãƒ‘": "6'^1", "ãƒ’": "6'-2", "ãƒ“": "6'=2", "ãƒ”": "6'^2", "ãƒ•": "6'-3", "ãƒ–": "6'=3", "ãƒ—": "6'^3", "ãƒ˜": "6'-4", "ãƒ™": "6'=4", "ãƒš": "6'^4", "ãƒ›": "6'-5", "ãƒœ": "6'=5", "ãƒ": "6'^5",
      "ãƒ": "7'-1", "ãƒŸ": "7'-2", "ãƒ ": "7'-3", "ãƒ¡": "7'-4", "ãƒ¢": "7'-5",
      "ãƒ¤": "8'-1", "ãƒ¦": "8'-3", "ãƒ¨": "8'-5",
      "ãƒ©": "9'-1", "ãƒª": "9'-2", "ãƒ«": "9'-3", "ãƒ¬": "9'-4", "ãƒ­": "9'-5",
      "ãƒ¯": "10'-1", "ãƒ²": "10'-3", "ãƒ³": "10'-5",
      "ãƒ¼": "12-1", "ã€": "12-2", "ã€‚": "12-3", "ï¼Ÿ": "12-4", "ï¼": "12-5", "?": "12-6", "!": "12-7", "-": "12-8", "+": "12-9", "Ã—": "12-10", "Ã·": "12-11", ",": "12-12", ".": "12-13", "/": "12-14", " ": "12-0", ")": "12-15", "(": "12-16", "]": "12-17", "[": "12-18", "ã€": "12-19", "ã€Œ": "12-20", ":": "12-21", ";": "12-21", "=": "12-22",
      "A": "13-1", "B": "13-2", "C": "13-3", "D": "13-4", "E": "13-5", "F": "13-6", "G": "13-7", "H": "13-8", "I": "13-9", "J": "13-10", "K": "13-11", "L": "13-12",
      "M": "13-13", "N": "13-14", "O": "13-15", "P": "13-16", "Q": "13-17", "R": "13-18", "S": "13-19", "T": "13-20", "U": "13-21", "V": "13-22", "W": "13-23", "X": "13-24", "Y": "13-25", "Z": "13-26",
      "a": "14-1", "b": "14-2", "c": "14-3", "d": "14-4", "e": "14-5", "f": "14-6", "g": "14-7", "h": "14-8", "i": "14-9", "j": "14-10", "k": "14-11", "l": "14-12",
      "m": "14-13", "n": "14-14", "o": "14-15", "p": "14-16", "q": "14-17", "r": "14-18", "s": "14-19", "t": "14-20", "u": "14-21", "v": "14-22", "w": "14-23", "x": "14-24", "y": "14-25", "z": "14-26",
      "0": "00;00", "1": "00;01", "2": "00;10", "3": "00;11", "4": "01;00", "5": "01;01", "6": "01;10", "7": "01;11", "8": "10;00", "9": "10;01"
    };

    function encrypt() {
      const input = document.getElementById("inputText").value;
      const chars = [...input];  // ä¿®æ­£ã•ã‚ŒãŸæ–‡å­—åˆ†å‰²
      const output = chars.map(ch => table[ch] || ch).join('  ');
      document.getElementById("outputText").value = output;
      if (document.getElementById("autoCopy").checked) {
        document.getElementById("inputText").value = output;
      }
      addHistory(output);
    }


    function decrypt() {
      const reversedTable = Object.fromEntries(Object.entries(table).map(([k, v]) => [v, k]));
      const input = document.getElementById("inputText").value.trim();
      const codes = input.split(/\s{2,}/);
      const output = codes.map(code => reversedTable[code] || code).join('');
      document.getElementById("outputText").value = output;
      if (document.getElementById("autoCopy").checked) {
        document.getElementById("inputText").value = output;
      }
      addHistory(output);
    }

    function clearFields() {
      document.getElementById("inputText").value = '';
      document.getElementById("outputText").value = '';
    }

    function copyToClipboard() {
      const text = document.getElementById("outputText").value;
      navigator.clipboard.writeText(text);
    }

    function addHistory(entry) {
      const history = document.getElementById("history");
      const container = document.createElement("div");
      container.className = "history-entry";
      const text = document.createElement("div");
      text.className = "history-text";
      text.textContent = entry;
      const delBtn = document.createElement("button");
      delBtn.className = "delete-btn";
      delBtn.textContent = "âŒ";
      delBtn.onclick = () => {
        container.remove();
        localStorage.setItem("history", history.innerHTML);
      };
      container.appendChild(text);
      container.appendChild(delBtn);
      history.prepend(container);
      localStorage.setItem("history", history.innerHTML);
    }

    function clearHistory() {
      document.getElementById("history").innerHTML = '';
      localStorage.removeItem("history");
    }

    function filterHistory() {
      const keyword = document.getElementById("historySearch").value.toLowerCase();
      const entries = document.querySelectorAll(".history-entry");
      entries.forEach(entry => {
        entry.style.display = entry.textContent.toLowerCase().includes(keyword) ? "flex" : "none";
      });
    }

    function downloadOutput() {
      const content = document.getElementById("outputText").value;
      const blob = new Blob([content], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "output.txt";
      a.click();
      URL.revokeObjectURL(url);
    }

    function loadFromFile(event) {
      const file = event.target.files[0];
      const reader = new FileReader();
      reader.onload = e => {
        document.getElementById("inputText").value = e.target.result;
      };
      reader.readAsText(file);
    }

    window.onload = () => {
      const savedHistory = localStorage.getItem("history");
      if (savedHistory) {
        document.getElementById("history").innerHTML = savedHistory;
        const deleteButtons = document.querySelectorAll(".delete-btn");
        deleteButtons.forEach(btn => btn.onclick = () => {
          btn.parentElement.remove();
          localStorage.setItem("history", document.getElementById("history").innerHTML);
        });
      }
    }
  </script>
</body>
</html>
